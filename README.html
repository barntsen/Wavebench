<h1
id="wavebench---performance-and-portability-of-seismic-visco-acoustic-wave-simulation">Wavebench
- Performance and Portability of Seismic Visco Acoustic wave
simulation</h1>
<h2 id="overview">Overview</h2>
<figure>
<img src="solvertime-gh200.png"
alt="Run times for GH200. Black line is machine generated cuda, red line is hand coded cuda with manual memory management, while blue line is hand coded cuda with unified memory management" />
<figcaption aria-hidden="true">Run times for GH200. Black line is
machine generated cuda, red line is hand coded cuda with manual memory
management, while blue line is hand coded cuda with unified memory
management</figcaption>
</figure>
<p>Wavebench is a set of benchmark programs to measure the efficiency
iand portability of machine generated cuda/hip code relative to hand
coded cuda/hip.</p>
<p>Machine generated cuda/hip is made via eps, a small Domain Specific
Languge. The main idea is to use the same source code for different
architectures. Parallelization is handled by a parallel construct (aka
fortran doconcurrent) as in</p>
<pre><code># Faxpy is a simple matrix addition test

def int faxpy2d(float [*,*] a, float [*,*] x, float [*,*] y, float b):
 int i,j
 int nx,ny

 nx=len(x,0)
 ny=len(x,1)

 parallel(i=0:nx,j=0:ny):
   a[i,j] = b*y[i,j]+x[i,j]</code></pre>
<p>There are also tests for manual memory management and unified
(automatic) memory management. The benchmarks contain tests relevant for
elastic wave simulations using the finite difference code.</p>
<p>The source code is in cuda/hip or machine generated cuda/hip by the
eps <a href="https://github.com/barntsen/Wavebench">Eps</a>
transpiler.</p>
<p>Above is a figure showing the performance of acoustic wave simulation
on GH200.</p>
<figure>
<img src="solvertime-gh200.png"
alt="Run times for GH200. Black line is machine generated cuda, red line is hand coded cuda with manual memory management, while blue line is hand coded cuda with unified memory management" />
<figcaption aria-hidden="true">Run times for GH200. Black line is
machine generated cuda, red line is hand coded cuda with manual memory
management, while blue line is hand coded cuda with unified memory
management</figcaption>
</figure>
<h2 id="directories">Directories</h2>
<p>The file tree is organized as shown below</p>
<pre><code>.
├── Benchmarks
│   ├── Bin
│   │   └── 
│   ├── Src
│   │   ├── Ac2d
│   │   ├── Diff
│   │   └── Faxpy
│   └── Tests
│       ├── Ac2d
│       ├── Diff
│       └── Faxpy
├── Paper
├── Presentations
│   ├── Status-sigma2-2023
│   │   └── Fig
│   └── Status-sigma2-2025
│       └── Figs
└── References</code></pre>
<p>The Tests directory contain subdirectories for each test, which again
contains the results for each architecture. F.ex the Ac2d subdirectory
contains:</p>
<pre><code>.
├── A100
│   ├── C
│   ├── Cuda
│   ├── Cuda-um
│   └── Eps
├── AMD-EPYC-Turin
│   ├── C
│   └── Eps
├── GH200
│   ├── C
│   ├── Cuda
│   ├── Cuda-um
│   └── Eps
├── i7-14700HX
│   ├── C
│   └── Eps
├── Mi250x
│   ├── Eps
│   ├── Hip
│   └── Hip-um
├── Plots
├── RTX4070
│   ├── C
│   ├── Cuda
│   ├── Cuda-um
│   ├── Eps
│   └── Python-cuda
└── Scripts</code></pre>
<p>The plot directory contains scripts (and pdfs) for displaying the
results.</p>
